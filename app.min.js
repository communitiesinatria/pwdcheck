function hexString(t){const e=new Uint8Array(t),s=[...e].map(t=>{const e=t.toString(16),s=e.padStart(2,"0");return s.toUpperCase()});return s.join("")}function digestMessage(t){const e=new TextEncoder,s=e.encode(t);return window.crypto.subtle.digest("SHA-1",s)}async function runCheck(t){if(""===t)return!1;const e=await digestMessage(t);hash=hexString(e),first=hash.substring(0,5),last=hash.substring(5);const s=await fetch("https://api.pwnedpasswords.com/range/"+first);if(200!==s.status)return void console.log("Looks like there was a problem. Status Code: "+s.status);const n=await s.text(),o=n.split("\r\n");let a=null;return o.forEach(e=>{let s=e.split(":");s[0]==last&&(a={text:t,hash:hash,count:s[1]})}),a}function onsubmit(t){t.preventDefault(),console.log("running");const e=document.querySelector("input").value;document.querySelector("input").value="";const s=document.querySelector(".output"),n=s.querySelector("h1"),o=s.querySelector("span");(async()=>{s.className="output",s.style.display="block",s.classList.add("searching");const t=await runCheck(e);s.classList.remove("searching"),t?(s.classList.add("warn"),n.textContent="YOUR PASSWORD IS LEAKED",o.textContent=`your password was found ${t.count} times in leaked password dumps`):(s.classList.add("safe"),n.textContent="Your Password is safe to use",o.textContent="")})()}let first="",last="",hash="";document.querySelector("form").addEventListener("submit",onsubmit);